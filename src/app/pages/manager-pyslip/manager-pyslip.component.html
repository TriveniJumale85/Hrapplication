<div class="container mt-5">
  <div class="card shadow-lg">
    <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
      <h4 class="mb-0">ğŸ“„ Salary Records</h4>
    </div>

    <div class="card-body table-responsive">
      <table class="table table-hover table-bordered align-middle text-center">
        <thead class="table-dark">
          <tr>
            <th>Sr.No</th>
            <th>ğŸ“ File Name</th>
            <th>ğŸ“† Month</th>
            <th>ğŸ‘¤ Uploaded By</th>
            <th>ğŸ•’ Upload Date</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody *ngIf="salaryRecords.length > 0; else noData">
          <tr *ngFor="let record of salaryRecords; let i = index">
            <td>{{ i + 1 }}</td>
            <td>{{ record.fileName }}</td>
            <td>{{ record.month }}</td>
            <td>{{ record.uploadedBy }}</td>
            <td>{{ record.uploadDate | date: 'short' }}</td>
            <td>
              <!-- Preview Button -->
              <button class="btn btn-outline-success btn-sm me-1" 
                      (click)="previewFile(record.id)">
                <span class="material-icons">visibility</span>
              </button>

              <!-- Download Button (Disabled until previewed) -->
              <button class="btn btn-outline-primary btn-sm"
                      [disabled]="!previewedBlobUrl"
                      (click)="downloadFile(record.fileName)">
                <span class="material-icons">download</span>
              </button>
            </td>
          </tr>
        </tbody>
      </table>

      <ng-template #noData>
        <p class="text-center mt-4 text-muted">No records found.</p>
      </ng-template>
    </div>
  </div>
</div>

<!-- Preview Modal -->
<div class="modal fade" id="previewModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-xl modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Document Preview</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <iframe *ngIf="previewUrl" 
                [src]="previewUrl"
                type="application/pdf"
                width="100%" 
                height="600px" 
                style="border:none;">
        </iframe>
      </div>
    </div>
  </div>
</div>
